$().ready(function () {  var belongUserObj = {    "userBelong":function () {      var param = {};      param["userId"] = $("#userId").val();      param["roleId"] = $("#roleId").val();      param["higherLevelUsers"] = [];      param["lowerLevelUsers"] = [];      var higherLevelUsersId = $("#higherLevelUsers").val();      var lowerLevelUsersId = $("#lowerLevelUsers").val();      if(""!=higherLevelUsersId){        var higherLevelUsers = [];        $("#"+higherLevelUsersId).find(".belongUser").each(function(){          if($(this).is(':checked')) {            var user = {};            user["userId"] = $(this).val();            higherLevelUsers.push(user);          }        });        param["higherLevelUsers"] = higherLevelUsers;      }      if(""!=lowerLevelUsersId){        var lowerLevelUsers = [];        $("#"+lowerLevelUsersId).find(".belongUser").each(function(){          if($(this).is(':checked')) {            var user = {};            user["userId"] = $(this).val();            lowerLevelUsers.push(user);          }        });        param["lowerLevelUsers"] = lowerLevelUsers;      }      var ajaxObj = {        url: "/user/userBelong",        param: JSON.stringify(param),        method: "POST",        contentType: "application/json"      };      commonJS.sendAjaxRequest(ajaxObj, function(data) {        if(data.code=="1"){          toastObj.toastMsg(true, true, "toast-top-center", "success", "新增成功");          window.location.href = "/user/userManage";        }else{          toastObj.toastMsg(true, true, "toast-top-center", "warning", data.message);        }      });    },    getDepartmentRoles:function () {      var departmentId = $("#departmentId").val();      if(""==departmentId) {        var options = "<option value=''>请选择</option>";        $("#roleId").html(options);        return;      }      var param = {};      param["departmentId"] = departmentId;      var ajaxObj = {        url: "/role/getDepartmentRoles",        param: param,        method: "GET",        contentType: "application/json"      };      commonJS.sendAjaxRequest(ajaxObj, function(data) {        if(data.code=="1"){          var options = "<option value=''>请选择</option>";          $("#roleId").html(options+$("#roleOptionsTemplate").render(data.data));          $("#roleId").val($("#originRoleId").val());          belongUserObj.showDepartmentUsers();        }else{        }      });    },    belongUserShow:function (roleTypeUserId,departmentId,roleType,templateId,userId) {      var param = {};      param["departmentId"] = departmentId;      param["roleType"] = roleType;      param["userId"] = userId;      var ajaxObj = {        url: "/user/departmentUsers",        param: param,        method: "GET",        contentType: "application/json"      };      commonJS.sendAjaxRequest(ajaxObj, function(data) {          console.log(templateId)        if(data.code=="1"){           // $("#"+roleTypeUserId).html($("#"+templateId).render(data.data));            var _class="checkbox";            if(templateId=="radioTemplate"){                _class="radio";            }            var html="";            $(data.data).each(function (index,value) {                if(value.isBelong) {                    html=html+"<div class='"+_class+" lable-boxs'><label><input type='"+_class+"' class='belongUser' name='"+_class+"User' " +                        " value='"+value.userId+"' checked>"+value.userName +"</label></div>";                }else{                    html=html+"<div class='"+_class+" lable-boxs'><label><input type='"+_class+"' class='belongUser' name='"+_class+"User' " +                        " value='"+value.userId+"'>"+value.userName +"</label></div>";                }            })            $("#"+roleTypeUserId).html(html);        }else{        }      });    },    showDepartmentUsers:function () {      $(".roleType").hide();      $("#roleType2User").html();      $("#roleType3User1").html();      $("#roleType3User2").html();      $("#roleType4User").html();      var departmentId = $("#departmentId").val();      var roleType = $("#roleId").find("option:selected").attr("data-roletype");      var userId=$("#userId").val();      if(""==departmentId||""==roleType) {        return;      }      $("#higherLevelUsers").attr("value", "");      $("#lowerLevelUsers").attr("value", "");      if(roleType=="2"){        belongUserObj.belongUserShow("roleType2User",departmentId,3,"checkboxTemplate",userId);        $("#lowerLevelUsers").attr("value", "roleType2User");      }else if(roleType=="3"){        belongUserObj.belongUserShow("roleType3User1",departmentId,2,"checkboxTemplate",userId);        belongUserObj.belongUserShow("roleType3User2",departmentId,4,"checkboxTemplate",userId);        $("#higherLevelUsers").attr("value", "roleType3User1");        $("#lowerLevelUsers").attr("value", "roleType3User2");      }else if(roleType=="4"){        belongUserObj.belongUserShow("roleType4User1",departmentId,3,"checkboxTemplate",userId);        $("#lowerLevelUsers").attr("value", "roleType4User1");      }      $("#roleType"+roleType).show();    }  };  var icon = "<i class='fa fa-times-circle'></i> ";  var addUserRoleFormValidate = $("#addUserRoleForm").validate({    rules: {      departmentId:{        required: true      },      roleId:{        required: true      }    },    messages: {      departmentId: {        required: icon + "请选择归属部门"      },      roleId:{        required: icon + "请选择用户角色"      }    },    submitHandler:function (form) {      belongUserObj.userBelong();    },    invalidHandler:function (form,validator) {      return false;    }  });  $("#departmentId").on("change",function () {    belongUserObj.getDepartmentRoles();  });  $("#roleId").on("change",function () {    belongUserObj.showDepartmentUsers();  });  belongUserObj.getDepartmentRoles();});